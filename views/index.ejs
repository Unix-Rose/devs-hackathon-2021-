<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="stylesheet" type="text/css" href="/md-style.css" />
    <title>Document</title>
</head>

<body>

    <!-- Search bar in top left corner. -->
    <header>
        <form action="/" method="GET" class="search-form">
            <input id="search" name="q" type="text" value="<%= searchQuery %>"
                placeholder="What are you looking for?" />
            <input type="submit" value="Search">

            <div class="chk-container">
                <div class="round">
                  <input type="checkbox" name="excludeSearchCommand" id="excludeSearchCommand" <%= excludeSearchCommand ? "checked" : "" %> />
                  <label for="excludeSearchCommand"></label>
                </div>
                <label class="chk-label" for="excludeSearchCommand">Command Snippets</label>
            </div>

            <div class="chk-container">
                <div class="round">
                  <input type="checkbox" name="excludeSearchCode" id="excludeSearchCode" <%=excludeSearchCode ? "checked" : "" %> />
                  <label for="excludeSearchCode"></label>
                </div>
                <label class="chk-label" for="excludeSearchCode">Code Snippets</label>
            </div>
        </form>
    </header>

    <main>
        <!-- Buttons for navigating to code/command snippets. -->
        <!-- These links are temporary. Change them later. -->
        <section class="btn-container" id="view-snippets">
            <a class="btn" href="/snip/python-a">Code Snippets</a>
            <a class="btn" href="/snip/python-b">Command Snippets</a>
        </section>

        <!-- Buttons for navigating to the forms for creating 
        code/command snippets. -->
        <section class="btn-container" id="create-snippets">
            <a class="btn" href="/snip/new/code">Create code snippet</a>
            <a class="btn" href="/snip/new/command">Create command snippet</a>
        </section>

        </section>

        <!-- Display snippets. -->
        <%- include('snippets') %>

        <!-- Display all code snippets. -->
        <section id="snippets-header">
            Code snippets
        </section>
        <% snippets.forEach(snip=> { %>
            <% if (snip.kind === "CodeSnippet") { %>
                <button type="button" class="collapsible">
                    <%=snip.title%>
                </button>
                <div class="snippet-container">
                    <span>
                        <b>Associated language: </b><%= snip.language%>
                    </span>
                    <div class="snippet-md">
                        <%- snip.meta_html_sanitised %>
                    </div>
                    <h4><strong>Tags</strong></h4>
                    <ul class="list">
                        <% snip.tags.forEach(tag=> { %>
                            <a class="link" href="/snip/python-b">
                                <%= tag %>
                            </a>
                        <% }); %>
                    </ul>

                    <!-- Snippet Controls -->
                    <ul class="list">
                        <a class="link" href="/snip/<%= snip.meta_slug %>">View</a>
                        <a class="link" href="/snip/<%= snip.meta_slug %>/edit">Edit</a>
                        <a class="link" href="/snip/<%= snip.meta_slug %>/delete">Delete</a>
                    </ul>
                </div>
            <% } %>
        <% }); %>

        <section id="snippets-header">
            Command snippets
        </section>
        <% snippets.forEach(snip=> { %>
            <% if (snip.kind === "CommandSnippet") { %>
                <button type="button" class="collapsible">
                    <%=snip.title%>
                </button>
                <div class="snippet-container">
                    <span>
                        <b>Associated program: </b><%= snip.program %>
                    </span>
                    <%- snip.meta_html_sanitised %>
                    <h4><strong>Tags</strong></h4>
                    <ul class="list">
                        <% snip.tags.forEach(tag=> { %>
                            <a class="link" href="/snip/python-b">
                                <%= tag %>
                            </a>
                        <% }); %>
                    </ul>

                    <!-- Snippet Controls -->
                    <ul class="list">
                        <a class="link" href="/snip/<%= snip.meta_slug %>">View</a>
                        <a class="link" href="/snip/<%= snip.meta_slug %>/edit">Edit</a>
                        <a class="link" href="/snip/<%= snip.meta_slug %>/delete">Delete</a>
                    </ul>
                </div>
            <% } %>
        <% }); %>

        <!-- Collapser Script -->
        <script>
            var coll = document.getElementsByClassName("collapsible");
            var i;

            for (i = 0; i < coll.length; i++) {
                coll[i].addEventListener("click", function () {
                    this.classList.toggle("active");
                    var content = this.nextElementSibling;
                    if (content.style.display === "block") {
                        content.style.display = "none";
                    } else {
                        content.style.display = "block";
                    }
                });
            }
        </script>

    </main>
</body>
</html>